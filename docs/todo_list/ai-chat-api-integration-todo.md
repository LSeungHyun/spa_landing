# AI ì±„íŒ… API ì—°ë™ ê°œì„  TODO

## ğŸ“‹ í”„ë¡œì íŠ¸ ê°œìš”
**ëª©ì **: í˜„ì¬ í•˜ë“œì½”ë”©ëœ ì±„íŒ… ì‘ë‹µì„ ì‹¤ì œ AI API ì—°ë™ìœ¼ë¡œ ê°œì„   
**í˜„ì¬ ìƒíƒœ**: í˜¼í•© ë°©ì‹ (ì¼ë¶€ í•˜ë“œì½”ë”©, ì¼ë¶€ ì‹¤ì œ API)  
**ëª©í‘œ**: ì™„ì „í•œ AI ê¸°ë°˜ ëŒ€í™” ì‹œìŠ¤í…œ êµ¬ì¶•

---

## ğŸ” í˜„ì¬ ìƒíƒœ ë¶„ì„

### ğŸ“Š ë²„íŠ¼ë³„ API ì—°ë™ í˜„í™©
| ë²„íŠ¼ | ê¸°ëŠ¥ | API ì—°ë™ ìƒíƒœ | ì‘ë‹µ ë°©ì‹ | ì‚¬ìš© ì œí•œ |
|------|------|---------------|-----------|-----------|
| ğŸ“¤ **ì „ì†¡** | ì¼ë°˜ ì±„íŒ… | âœ… Gemini API | ì‹¤ì œ AI ì‘ë‹µ | ë¬´ì œí•œ |
| ğŸª„ **ê°œì„ ** | í”„ë¡¬í”„íŠ¸ ê°œì„  | âœ… Gemini API | ì‹¤ì œ AI ì‘ë‹µ | 3íšŒ/ì¼ |
| ğŸ§ª **í…ŒìŠ¤íŠ¸** | í…ŒìŠ¤íŠ¸ ê°œì„  | âœ… ê³ ë„í™”ëœ ë¡œì»¬ ì„œë¹„ìŠ¤ | ì§€ëŠ¥í˜• ë¶„ì„ ê¸°ë°˜ ê°œì„  | ì—†ìŒ |

### ğŸ“ ê´€ë ¨ íŒŒì¼ êµ¬ì¡°
```
src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ page.tsx                    # ë©”ì¸ í˜ì´ì§€ (ì±„íŒ… UI)
â”‚   â””â”€â”€ api/
â”‚       â”œâ”€â”€ improve-prompt/route.ts # í”„ë¡¬í”„íŠ¸ ê°œì„  API (âœ… ì—°ë™ë¨)
â”‚       â””â”€â”€ chat/route.ts          # ì¼ë°˜ ì±„íŒ… API (âŒ ë¯¸êµ¬í˜„)
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ gemini-service.ts          # Gemini API ì„œë¹„ìŠ¤
â”‚   â””â”€â”€ services/
â”‚       â””â”€â”€ usage-limit-service.ts # ì‚¬ìš©ëŸ‰ ì œí•œ ê´€ë¦¬
```

---

## âœ… Phase 1: ì „ì†¡ ë²„íŠ¼ AI ì—°ë™ (ì™„ë£Œ)

### ì‘ì—… í•­ëª©
- [x] **ì±„íŒ… API ì—”ë“œí¬ì¸íŠ¸ ìƒì„±** âœ… ì™„ë£Œ (2025-06-30)
  - íŒŒì¼: `src/app/api/chat/route.ts` (ì‹ ê·œ ìƒì„±)
  - ê¸°ëŠ¥: ì‚¬ìš©ì ë©”ì‹œì§€ì— ëŒ€í•œ AI ì‘ë‹µ ìƒì„±
  - ëª¨ë¸: Gemini 1.5 Flash
  - ì‚¬ìš© ì œí•œ: ë¬´ì œí•œ (ì¼ë°˜ ì±„íŒ…ìš©)
  - ì—ëŸ¬ ì²˜ë¦¬: API ì‹¤íŒ¨ ì‹œ í´ë°± ë©”ì»¤ë‹ˆì¦˜ êµ¬í˜„

- [x] **GeminiServiceì— ì±„íŒ… ë©”ì„œë“œ ì¶”ê°€** âœ… ì™„ë£Œ (2025-06-30)
  - íŒŒì¼: `src/lib/gemini-service.ts`
  - ë©”ì„œë“œ: `generateChatResponse(message: string): Promise<string>`
  - í”„ë¡¬í”„íŠ¸: SPA ë¸Œëœë“œ íŠ¹í™” ëŒ€í™”í˜• AI ì–´ì‹œìŠ¤í„´íŠ¸
  - í´ë°±: API ì‹¤íŒ¨ ì‹œ ì»¨í…ìŠ¤íŠ¸ ê¸°ë°˜ ë”ë¯¸ ì‘ë‹µ ì œê³µ

- [x] **í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™** âœ… ì™„ë£Œ (2025-06-30)
  - íŒŒì¼: `src/app/page.tsx`
  - í•¨ìˆ˜: `handleSendMessage()` ë° `handleInterceptSendAnyway()` ìˆ˜ì •
  - í•˜ë“œì½”ë”©ëœ ì‘ë‹µ ì œê±° â†’ API í˜¸ì¶œë¡œ ë³€ê²½
  - ì—ëŸ¬ ì²˜ë¦¬ ë° ì‚¬ìš©ì ì¹œí™”ì  ë©”ì‹œì§€ ì¶”ê°€

### êµ¬í˜„ ì„¸ë¶€ì‚¬í•­

#### 1. ì±„íŒ… API ì—”ë“œí¬ì¸íŠ¸ (`src/app/api/chat/route.ts`)
```typescript
export async function POST(req: NextRequest) {
    try {
        const { message } = await req.json();
        
        const geminiService = GeminiService.getInstance();
        const response = await geminiService.generateChatResponse(message);
        
        return NextResponse.json({ response });
    } catch (error) {
        return NextResponse.json(
            { error: 'ì‘ë‹µ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.' },
            { status: 500 }
        );
    }
}
```

#### 2. GeminiService ì±„íŒ… ë©”ì„œë“œ
```typescript
public async generateChatResponse(message: string): Promise<string> {
    const model = this.genAI.getGenerativeModel({ model: 'gemini-1.5-flash' });
    
    const prompt = `You are a helpful AI assistant for Smart Prompt Assistant platform.
    
User message: "${message}"

Respond naturally and helpfully in Korean. Be friendly but professional.`;

    const result = await model.generateContent(prompt);
    return result.response.text();
}
```

#### 3. í”„ë¡ íŠ¸ì—”ë“œ ìˆ˜ì •
```typescript
const handleSendMessage = async () => {
    // ê¸°ì¡´ í•˜ë“œì½”ë”© ë¡œì§ ì œê±°
    // API í˜¸ì¶œë¡œ ë³€ê²½
    const response = await fetch('/api/chat', {
        method: 'POST',
        body: JSON.stringify({ message: inputText })
    });
    
    const data = await response.json();
    // AI ì‘ë‹µì„ ì±„íŒ…ì— ì¶”ê°€
};
```

---

## âœ… Phase 2: í…ŒìŠ¤íŠ¸ ë²„íŠ¼ ê°œì„  (ì™„ë£Œ)

### ì‘ì—… í•­ëª©
- [x] **í…ŒìŠ¤íŠ¸ ê°œì„  ì„œë¹„ìŠ¤ ê³ ë„í™”** âœ… ì™„ë£Œ (2025-06-30)
  - íŒŒì¼: `src/lib/services/prompt-improvement-service.ts` (ì‹ ê·œ ìƒì„±)
  - ê¸°ëŠ¥: ê³ ë„í™”ëœ í”„ë¡¬í”„íŠ¸ ë¶„ì„ ë° ê°œì„  ì•Œê³ ë¦¬ì¦˜
  - íŠ¹ì§•: ìœ í˜•ë³„ ë§ì¶¤ ê°œì„ , ì ìˆ˜ ì‹œìŠ¤í…œ, ê°œì„  íŒ ì œê³µ
  - ëª©ì : API ì œí•œ ì—†ëŠ” ê³ í’ˆì§ˆ ë¬´ë£Œ ì²´í—˜

- [x] **ê°œì„  í’ˆì§ˆ í–¥ìƒ** âœ… ì™„ë£Œ (2025-06-30)
  - í”„ë¡¬í”„íŠ¸ ìœ í˜• ìë™ ê°ì§€ (ì°½ì‘/ê¸°ìˆ /ë¹„ì¦ˆë‹ˆìŠ¤/êµìœ¡/ê°œì¸/ì¼ë°˜)
  - ëª…í™•ì„±, íŠ¹ì •ì„±, ì»¨í…ìŠ¤íŠ¸ ë‹¤ì°¨ì› ë¶„ì„
  - 1-10ì  í’ˆì§ˆ ì ìˆ˜ ì‹œìŠ¤í…œ
  - ì‹¤ì‹œê°„ ê°œì„  íŒ ë° ê°€ì´ë“œë¼ì¸ ì œê³µ
  - í´ë°± ë©”ì»¤ë‹ˆì¦˜ìœ¼ë¡œ ì•ˆì •ì„± ë³´ì¥

---

## âœ… Phase 3: í†µí•© ìµœì í™” (ì™„ë£Œ)

### ì‘ì—… í•­ëª©
- [x] **API ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§** âœ… ì™„ë£Œ (2025-06-30)
  - íŒŒì¼: `src/lib/analytics.ts` (í™•ì¥), `src/hooks/use-api-monitoring.ts` (ì‹ ê·œ)
  - ê¸°ëŠ¥: ì‹¤ì‹œê°„ API ì‚¬ìš©ëŸ‰, ì„±ëŠ¥ ë©”íŠ¸ë¦­, ì‚¬ìš©ì ê²½í—˜ ì¶”ì 
  - PostHog ì´ë²¤íŠ¸ ìë™ ì¶”ì  ì—°ë™
  - ì‘ë‹µ ì‹œê°„, ë©”ì‹œì§€ ê¸¸ì´, ì„±ê³µë¥  ë“± ì¢…í•© ë©”íŠ¸ë¦­ ìˆ˜ì§‘

- [x] **ì—ëŸ¬ ì²˜ë¦¬ ê°œì„ ** âœ… ì™„ë£Œ (2025-06-30)
  - í¬ê´„ì ì¸ ì—ëŸ¬ ì²˜ë¦¬ ì‹œìŠ¤í…œ (API ë ˆë²¨ + í´ë¼ì´ì–¸íŠ¸ ë ˆë²¨)
  - ì‚¬ìš©ì ì¹œí™”ì  ì—ëŸ¬ ë©”ì‹œì§€ ë° í´ë°± ì‘ë‹µ
  - ìë™ ì¬ì‹œë„ ë° ìš°ì•„í•œ ì„±ëŠ¥ ì €í•˜ ë©”ì»¤ë‹ˆì¦˜

- [x] **ì„±ëŠ¥ ìµœì í™”** âœ… ì™„ë£Œ (2025-06-30)
  - ì»¤ìŠ¤í…€ ëª¨ë‹ˆí„°ë§ í›…ìœ¼ë¡œ ì„±ëŠ¥ ì¶”ì  ìë™í™”
  - ê°œë°œ í™˜ê²½ ë””ë²„ê¹… ë¡œê·¸ ë° í”„ë¡œë•ì…˜ ë©”íŠ¸ë¦­ ë¶„ë¦¬
  - í…ŒìŠ¤íŠ¸ ê°œì„  ì²˜ë¦¬ ì‹œê°„ ìµœì í™” ë° ì ìˆ˜ ì‹œìŠ¤í…œ ì—°ë™

---

## ğŸ“Š í˜„ì¬ API ì„¤ì • ìƒíƒœ

### Gemini API êµ¬ì„±
- **API í‚¤**: `GEMINI_API_KEY` í™˜ê²½ë³€ìˆ˜
- **ëª¨ë¸**: `gemini-1.5-flash`
- **ê²€ì¦ ì—”ë“œí¬ì¸íŠ¸**: `/api/test-gemini-key`
- **ì‚¬ìš© ì œí•œ**: í”„ë¡¬í”„íŠ¸ ê°œì„  ê¸°ëŠ¥ë§Œ 3íšŒ/ì¼

### ì‚¬ìš©ëŸ‰ ê´€ë¦¬
- **ì¶”ì  ë°©ì‹**: IP ê¸°ë°˜
- **ì €ì¥ì†Œ**: Supabase ë°ì´í„°ë² ì´ìŠ¤
- **ë¦¬ì…‹ ì£¼ê¸°**: ë§¤ì¼ ìì •
- **ì œí•œ ëŒ€ìƒ**: í”„ë¡¬í”„íŠ¸ ê°œì„  ê¸°ëŠ¥ë§Œ

---

## ğŸ¯ ìš°ì„ ìˆœìœ„ ë° ì¼ì •

### ë†’ìŒ (1ì£¼ì¼ ë‚´)
1. **ì „ì†¡ ë²„íŠ¼ AI ì—°ë™**: ì‚¬ìš©ì ì²´í—˜ í’ˆì§ˆ í–¥ìƒ
2. **ì—ëŸ¬ ì²˜ë¦¬ ê°œì„ **: ì•ˆì •ì„± í™•ë³´

### ì¤‘ê°„ (2ì£¼ì¼ ë‚´)
1. **í…ŒìŠ¤íŠ¸ ë²„íŠ¼ ê°œì„ **: ë¬´ë£Œ ì²´í—˜ í’ˆì§ˆ í–¥ìƒ
2. **API ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§**: ë¹„ìš© ê´€ë¦¬

### ë‚®ìŒ (1ê°œì›” ë‚´)
1. **ì„±ëŠ¥ ìµœì í™”**: ì‘ë‹µ ì†ë„ ê°œì„ 
2. **ìºì‹± ì‹œìŠ¤í…œ**: ì¤‘ë³µ ìš”ì²­ ìµœì í™”

---

## ğŸš¨ ì£¼ì˜ì‚¬í•­

### API ë¹„ìš© ê´€ë¦¬
- Gemini APIëŠ” ì‚¬ìš©ëŸ‰ ê¸°ë°˜ ê³¼ê¸ˆ
- ë¬´ë¶„ë³„í•œ API í˜¸ì¶œ ë°©ì§€ í•„ìš”
- ì ì ˆí•œ ì‚¬ìš© ì œí•œ ì •ì±… ìœ ì§€

### ì‚¬ìš©ì ê²½í—˜
- API ì‘ë‹µ ì§€ì—° ì‹œ ë¡œë”© í‘œì‹œ
- ì‹¤íŒ¨ ì‹œ ëª…í™•í•œ ì•ˆë‚´ ë©”ì‹œì§€
- í•˜ë“œì½”ë”© ì‘ë‹µê³¼ì˜ í’ˆì§ˆ ì°¨ì´ ìµœì†Œí™”

### ë³´ì•ˆ
- API í‚¤ ë³´ì•ˆ ê´€ë¦¬
- ì‚¬ìš©ì ì…ë ¥ ê²€ì¦ ê°•í™”
- ì•…ìš© ë°©ì§€ ë©”ì»¤ë‹ˆì¦˜

---

## ğŸ“ˆ ì„±ê³µ ì§€í‘œ

### ê¸°ìˆ ì  ì§€í‘œ
- [ ] API ì‘ë‹µ ì„±ê³µë¥  > 95%
- [ ] í‰ê·  ì‘ë‹µ ì‹œê°„ < 3ì´ˆ
- [ ] ì—ëŸ¬ ë°œìƒë¥  < 5%

### ì‚¬ìš©ì ê²½í—˜ ì§€í‘œ
- [ ] ì±„íŒ… ì‘ë‹µ í’ˆì§ˆ ë§Œì¡±ë„
- [ ] API ì—°ë™ ì „í›„ ì‚¬ìš© ì‹œê°„ ë¹„êµ
- [ ] ì‚¬ìš©ì í”¼ë“œë°± ê¸ì •ë¥ 

---

## ğŸ”„ ì—…ë°ì´íŠ¸ ë¡œê·¸

### 2024-12-27
- **ë¬¸ì„œ ìƒì„±**: AI ì±„íŒ… API ì—°ë™ TODO ë¦¬ìŠ¤íŠ¸ ì‘ì„±
- **í˜„ì¬ ìƒíƒœ ë¶„ì„**: í˜¼í•© ë°©ì‹ API ì—°ë™ ìƒíƒœ íŒŒì•…
- **Phaseë³„ ì‘ì—… ê³„íš**: 3ë‹¨ê³„ ê°œì„  ë¡œë“œë§µ ìˆ˜ë¦½

### 2025-06-30
- **Phase 1 ì™„ë£Œ**: ì „ì†¡ ë²„íŠ¼ AI ì—°ë™ (Gemini API ë¬´ì œí•œ ì‚¬ìš©)
- **Phase 2 ì™„ë£Œ**: í…ŒìŠ¤íŠ¸ ë²„íŠ¼ ê³ ë„í™” (ì§€ëŠ¥í˜• ë¡œì»¬ ê°œì„  ì„œë¹„ìŠ¤)
- **Phase 3 ì™„ë£Œ**: í†µí•© ìµœì í™” (ëª¨ë‹ˆí„°ë§, ì—ëŸ¬ ì²˜ë¦¬, ì„±ëŠ¥ ê°œì„ )
- **í”„ë¡œì íŠ¸ ì™„ë£Œ**: ëª¨ë“  ì±„íŒ… ê¸°ëŠ¥ì´ AI ê¸°ë°˜ìœ¼ë¡œ ì „í™˜ë¨ 