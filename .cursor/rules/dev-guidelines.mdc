---
description: 
globs: 
alwaysApply: true
---
## ğŸ‡ºğŸ‡¸ dev-guidelines.mdc (English)

````mdc
<!-- ruleType: always -->

You are an expert in practical Next.js development. Apply the following rules to maintain stability, reduce production bugs, and ensure collaborative code quality in the SPA (ë…¼ë¬¸ ì´ˆë¡/ì„œë¡  ìë™ ìƒì„±ê¸°) project.

## ğŸ“Œ Rule Levels

- **Required**: Enforced via CI and code review.
- **Recommended**: Default unless justified with TODO or issue.
- **Optional**: Good-to-have; apply if resources/time allow.

---

## ğŸ“ Mobile-First Guideline Reference

For all UI and UX decisions, especially regarding responsive layouts and performance on small screens, please refer to the **Mobile-First Guide** (`mobile-first.mdc`). It covers:

- Mobile-first design principles
- Mandatory responsive structures
- Mobile UX/UI standards
- Real device QA & performance checks

Ensure you have read the Mobile-First Guide and apply its rules in parallel with this dev-guidelines file. Any conflicts or exceptions should be documented with a TODO + issue link, following our standard exception process.


## âœ… Development Rules

### ğŸ”§ 1. Lint & Format (Required)

- ESLint: `typescript-eslint`, `jsx-a11y`
- Prettier with `.prettierrc`
- Husky: `pre-commit` with `pnpm lint` + `pnpm test`
```bash
pnpm lint
pnpm test
````

---

### ğŸ“ 2. Folder & Naming (Recommended)

* Domain-based folders: `/features/[domain]`
* File naming: kebab-case, hooks: `useCamelCase`
* Full guide â†’ `docs/folder-structure-naming.md`

---

### ğŸš¨ 3. CI Blocking Rules (Required)

* ESLint errors â†’ block
* Prettier misformatted â†’ block
* Jest test failures â†’ block
* Supabase migration/policy fail â†’ block
* Test coverage:

  * Global < 80% â†’ warn
  * Critical modules (`auth`, `community`, `vendor`) < 90% â†’ block

---

### â— 4. Common Mistakes

* Unnecessary `use client`
* `any` without comments
* Global state misuse
* Redundant type annotations
* Missing commit prefix

---

### ğŸ§ª 5. Testing (Recommended)

* `.test.ts` next to logic files
* `/e2e` for Playwright or Cypress
* `jest.config.ts`, `/test/setup.ts`
* Use `/features/_template/` as scaffold

---

### ğŸ” 6. Security (Required)

* Validate input with Zod
* Sanitize HTML (`DOMPurify`)
* Never commit `.env*` or secrets
* Apply RLS to private tables
* Rotate secrets regularly

---

### âš™ï¸ 7. State Management (Required)

* Local: `useState`
* Domain: TanStack Query (`/features/[x]/services`)
* Shared global: minimal under `/lib/auth`

---

### ğŸ“š 8. Documentation (Recommended)

* `README.md` per domain folder
* Use JSDoc for all exported hooks/functions
* Docs checklist in PR template

---

### ğŸ”€ 9. Git & PR (Recommended)

* Use `feat:`, `fix:`, `refactor:` etc.
* PR size â‰¤ 500 LOC
* Branch: `feature/auth-login`, `fix/community-bug`

---

### â™¿ 10. Accessibility (Recommended)

* Semantic HTML
* `alt`, `aria-*`, `tabIndex`
* Tools: `jest-axe`, Storybook a11y addon

---

### âš¡ 11. Performance (Optional)

* `next/dynamic` for lazy load
* `next/image` for optimization
* `useMemo`, `react-window` for long lists
* Run Lighthouse/Profiler per sprint

---

## ğŸ§ª Phase-Based Enforcement

| Phase | Required              | Recommended         | Optional       |
| ----- | --------------------- | ------------------- | -------------- |
| MVP   | Folder, Lint, Zustand | Commit format, Docs | Perf tuning    |
| QA    | Tests, Zod, a11y      | Docs, JSDoc         | Virtualization |
| PROD  | CI, RLS, migration    | Rollback, logging   | Perf budgets   |

---

## ğŸ› ï¸ Exceptions & Tech Debt

* Use TODO + issue link for rule violations
* Hotfixes allowed â†’ create a tech debt ticket
* Review debt monthly


## ğŸ“¦ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ê´€ë¦¬

ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ì€ ìˆœë²ˆ ê¸°ë°˜ ëª…ëª… ê·œì¹™ì„ ë”°ë¼ì•¼ í•©ë‹ˆë‹¤:
- í˜•ì‹: `NNN_feature_description.sql` (ì˜ˆ: `001_user_suggestions.sql`)
- í•­ìƒ `create-migration.ps1` ìŠ¤í¬ë¦½íŠ¸ë¡œ ìƒì„±
- ìì„¸í•œ ê·œì¹™ì€ `.cursor/rules/migrations.mdc` ì°¸ì¡°

---

## ğŸ“ Reference

ğŸ“ Folder/naming rules: `docs/folder-structure-naming.md`

````

---

### ğŸ›¡ï¸ ë°©ì–´ì  í”„ë¡œê·¸ë˜ë° (í•„ìˆ˜)

* ëª¨ë“  ì •ê·œì‹ match/exec í•¨ìˆ˜ ê²°ê³¼ëŠ” null ì²´í¬ í•„ìˆ˜
* module.contextì™€ ê°™ì€ ì™¸ë¶€ ì œê³µ ê°ì²´ ì ‘ê·¼ ì‹œ null/undefined ì²´í¬ í•„ìˆ˜
* ì˜µì…”ë„ ì²´ì´ë‹(?.) ë˜ëŠ” nullish ë³‘í•© ì—°ì‚°ì(??) ì ê·¹ í™œìš©
* ì™¸ë¶€ API ë°˜í™˜ê°’ í•­ìƒ ìœ íš¨ì„± ê²€ì¦



